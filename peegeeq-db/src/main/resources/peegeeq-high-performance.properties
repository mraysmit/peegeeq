# PeeGeeQ High-Performance Configuration
# Optimized for maximum throughput and low latency
# Use this configuration for performance benchmarks and high-throughput scenarios

# Database Configuration - Optimized for performance
peegeeq.database.host=localhost
peegeeq.database.port=5432
peegeeq.database.database=peegeeq
peegeeq.database.user=peegeeq
peegeeq.database.password=peegeeq
peegeeq.database.schema=public
peegeeq.database.ssl-mode=disable

# Connection Pool - Optimized following Vert.x performance checklist
# Set pool size (not 4): try 16/32 and tune with your DBA
peegeeq.database.pool.max-size=32
peegeeq.database.pool.min-size=8
peegeeq.database.pool.shared=true
peegeeq.database.pool.max-wait-queue-size=200
peegeeq.database.pool.connection-timeout=PT10S
peegeeq.database.pool.idle-timeout=PT30M
peegeeq.database.pool.max-lifetime=PT1H

# Pipelining Configuration - Enable/test pipelining (8–32)
peegeeq.database.pipelining.enabled=true
peegeeq.database.pipelining.limit=32

# Verticle Deployment - Deploy multiple instances (≃ cores)
peegeeq.verticle.instances=8

# Queue Configuration - Optimized for high throughput
peegeeq.queue.max-retries=3
peegeeq.queue.visibility-timeout=PT30S
peegeeq.queue.batch-size=100                    # Large batches for efficiency
peegeeq.queue.polling-interval=PT0.1S           # Fast polling (100ms)
peegeeq.queue.dead-letter.enabled=true
peegeeq.queue.priority.default=5

# Stuck Message Recovery - Faster recovery for performance
peegeeq.queue.recovery.enabled=true
peegeeq.queue.recovery.processing-timeout=PT2M
peegeeq.queue.recovery.check-interval=PT5M

# Consumer Configuration - Multiple threads for parallel processing
peegeeq.consumer.threads=8                      # Multiple consumer threads

# Metrics Configuration - Reduced reporting for performance
peegeeq.metrics.enabled=true
peegeeq.metrics.reporting-interval=PT30S        # Less frequent reporting
peegeeq.metrics.jvm.enabled=false               # Disable JVM metrics for performance
peegeeq.metrics.database.enabled=true
peegeeq.metrics.instance-id=peegeeq-high-performance

# Circuit Breaker - Relaxed for performance
peegeeq.circuit-breaker.enabled=true
peegeeq.circuit-breaker.failure-rate-threshold=80.0
peegeeq.circuit-breaker.slow-call-rate-threshold=80.0
peegeeq.circuit-breaker.slow-call-duration-threshold=PT2S
peegeeq.circuit-breaker.permitted-calls-in-half-open-state=5
peegeeq.circuit-breaker.sliding-window-size=50
peegeeq.circuit-breaker.minimum-number-of-calls=10
peegeeq.circuit-breaker.wait-duration-in-open-state=PT30S

# Backpressure - Optimized for high throughput
peegeeq.backpressure.enabled=true
peegeeq.backpressure.max-queue-size=10000       # Large queue for buffering
peegeeq.backpressure.high-watermark=8000
peegeeq.backpressure.low-watermark=2000
peegeeq.backpressure.check-interval=PT1S

# Health Check - Less frequent for performance
peegeeq.health.enabled=true
peegeeq.health.check-interval=PT30S             # Less frequent health checks
peegeeq.health.timeout=PT5S
peegeeq.health.failure-threshold=3
peegeeq.health.recovery-threshold=2

# Dead Letter Queue - Optimized settings
peegeeq.dead-letter.max-retries=3
peegeeq.dead-letter.retry-delay=PT1S
peegeeq.dead-letter.retention-period=P7D

# Performance Tuning Comments:
# - batch-size=100: Process 100 messages per batch for efficiency
# - polling-interval=PT0.1S: Poll every 100ms for low latency
# - consumer.threads=8: Use 8 threads for parallel processing
# - pool.max-size=20: Large connection pool for concurrency
# - metrics.jvm.enabled=false: Disable JVM metrics to reduce overhead
# - backpressure.max-queue-size=10000: Large buffer for high throughput
